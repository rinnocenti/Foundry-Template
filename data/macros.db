{"_id":"09xqTOV1aeFzmFZa","name":"teste movimento","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"let move= [0,5];\nlet face = token.data.rotation;\nlet g = canvas.scene.data.grid;\nlet mov = [0,0];\nconsole.log(face);\nif(face > -90 && face < 90 || face >= 0 && face > 270){\n    console.log(\"baixo\");\n    mov[1] = move[1];\n    if(move[0] != 0) \n        mov[0] = move[0] * -1;\n}\nif(face > 0 && face < 180 ||  face < -180 && face > -360){\n    console.log(\"esquerda\")\n    mov[0] = move[1] * -1;\n    if(move[0] != 0) \n    mov[1] = move[0] * -1;\n}\nif(face < -90 && face > -270 || face > 90 && face < 270){\n    console.log(\"cima\")\n    mov[1] = move[1] * -1;\n    if(move[0] != 0) \n        mov[0] = move[1];\n}\nif(face < 0 && face > -180 || face > 180 && face < 360){\n    console.log(\"direita\")\n    mov[0] = move[1];\n    if(move[0] != 0) \n    mov[1] = move[1];\n}\n\nlet newX = (token.x + (g * mov[0]));\nlet newY = (token.y + (g * mov[1]));\nconsole.log(mov, newY, newX);\ncanvas.tokens.controlled[0]._noAnimate = true\ntoken.update({x: newX, y:newY});","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"1QTF7h1biNR0g2Zo","name":"Journals Update ID to names","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":1000001,"flags":{"furnace":{"runAsGM":true},"cf":{"id":"temp_12ta9h39ac1","path":"Amostras#/CF_SEP/Generators","color":"#000000","import":true},"combat-utility-belt":{"macroTrigger":""}},"scope":"global","command":"game.journal.forEach(entry => {\n  if(entry.folder !== null && entry.folder.name !== \"UPDATE\") return;\n  if(entry.data.content == null) return;\n  let content = entry.data.content;\n  let matches = content.match(/@\\w*\\[([0-9A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ.\\- ]+)\\]/g);\n  \n  // now we have an array of things such as @Actor[5c8HWfrpvRV4XtZ1]\n  if(matches == null) return;\n  let newcontent = content;\n  let uniqueMatches = matches\n    .filter((value, index, self) => self.indexOf(value) === index) //unique matches\n    .forEach(str => {\n      let arrayData = str.slice(1, -1).split('['); // cut off the @ and ] then make [0] the type and [1] the id.\n      // since the reference may not match directly with the game entity type, lets look that up.\n      //console.log(arrayData)\n      let entityType = getEntityType(arrayData[0]);\n      let packname;\n      if(entityType == 'packs'){\n       let pck =  arrayData[1].split('.');\n       packname = `${pck[0]}.${pck[1]}`;\n       arrayData[1] = pck[2];\n      }\n      let id = arrayData[1];\n      let name;\n      // with the id and our entity type, look up the name of the entry.\n      if(entityType == 'packs'){\n          let packs = game[entityType].get(packname);\n          let pindex = packs.index.find(element => element._id === id) || packs.index.find(element => element.name === id);\n          //console.log(packs);\n          if(!pindex)\n            return ui.notifications.error(`Could not find any record for the entity type ${entityType} in pack ${packs.name} with the id of ${id}`);\n          name = pindex.name;\n      }else{\n          name = game[entityType].get(id)?.name;\n      }\n      //console.log(name)\n      if (!name) {\n        return ui.notifications.error(`Could not find any record for the entity type ${entityType} with the id of ${arrayData[0]}`);\n      }\n\n      // replace the ID with the name.\n      console.log(`updating ${id} with ${name}`);\n\n      let regEx = new RegExp(id, 'g');\n      newcontent = newcontent.replace(regEx, name);\n      //console.log(newcontent)\n    }); \n  entry.update({ content: newcontent });\n});\n\nfunction getEntityType(entity) {\n  switch (entity) {\n    case 'JournalEntry': return 'journal';\n    case 'RollTable': return 'tables';\n    case 'Compendium': return 'packs';\n    default: return entity.toLowerCase() + 's';\n  }\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"2wTKvlyQgjnJy3X1","name":"DAE Greapple","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"console.log(args);\n// \"DAE Greapple\" @token @target auto\nlet ttoken = canvas.tokens.get(args[1]);\nlet targets = canvas.tokens.get(args[2]);\nlet tactor = targets.actor;\nlet opt = args[args.length -1];\n\nif(args[0] === 'on' && (args[3] && args[3] !== opt)){\n    let skill = (tactor.data.data.skills.ath >= tactor.data.data.skills.acr) ? 'ath' : 'acr';\n    tactor.rollSkill('ath').then(async (result) => {\n        let res = await ttoken.actor.rollSkill(skill);\n        if (result.total >= res.total) {\n            game.cub.removeCondition(\"Grappled\", targets);\n        }\n    });\n}\n\nif (args[0] === \"each\") {\n    if(game.cub.hasCondition(\"Grappled\", tactor)){\n        let skill = (tactor.data.data.skills.ath >= tactor.data.data.skills.acr) ? 'ath' : 'acr';\n        tactor.rollSkill(skill).then(async (result) => {\n            if (result.total >= ttoken.actor.data.data.skills.ath.passive) {\n                game.cub.removeCondition(\"Grappled\", targets);\n                if(game.cub.hasCondition(\"Restrained\", tactor))\n                    game.cub.removeCondition(\"Restrained\", targets);\n                await targets.actor.deleteEmbeddedEntity(\"ActiveEffect\", opt.effectId);\n            }\n        });\n    }else{\n        await targets.actor.deleteEmbeddedEntity(\"ActiveEffect\", opt.effectId);\n    }\n}","author":"X4uo406iXTm4HkVN","img":"modules/combat-utility-belt/icons/grappled.svg","actorIds":[]}
{"name":"Xp Awards","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2100001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_3qd5z0dngmj","path":"Automação","color":"#0080c0","import":true}},"scope":"global","command":"(function () {\n\tfunction award_xp(type, amount) {\n\t\tlet actors = game.actors.entities.filter(e => e.data.type === 'character' && e.hasPlayerOwner);\n\t\tlet isShared = type == \"shared\";\n\t\tconsole.log(type + ' ' + amount);\n\t\tif (Number.isInteger(amount) && actors.length > 0) {\n\t\t\tlet totalAmount = isShared ? amount : amount * actors.length;\n\t\t\tlet individualAmount = isShared ? Math.floor(amount / actors.length) : amount\n\n\t\t\tlet chatContent = `\n\t\t\t<h1><img src=\"icons/commodities/treasure/crown-gold-laurel-wreath.webp\" width=\"50px\" /> XP Awards</h1>\n\t\t\t<b>${totalAmount} Experience Awarded!</b>\n\t\t\t<br>${individualAmount} added to:\n\t\t\t`;\n\n\t\t\tactors.forEach(actor => {\n\t\t\t\tchatContent += `<br>${actor.name}`;\n\t\t\t\tactor.update({\n\t\t\t\t\t\"data.details.xp.value\": actor.data.data.details.xp.value + individualAmount\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tlet chatData = {\n\t\t\t\tuser: game.user._id,\n\t\t\t\tspeaker: ChatMessage.getSpeaker(),\n\t\t\t\tcontent: chatContent,\n\t\t\t\ttype: CONST.CHAT_MESSAGE_TYPES.OTHER\n\t\t\t};\n\t\t\tChatMessage.create(chatData);\n\t\t}\n\t}\n\n\tnew Dialog({\n\t\ttitle: \"Award Party XP\",\n\t\tcontent: `\n\t <p>Select a type and an amount. Individual xp will give or take a set amount to/from each party member, whereas shared will split an amount evenly.</p>\n\t <form>\n\t  <div class=\"form-group\">\n\t   <label>Type:</label>\n\t   <select id=\"xp-type\">\n\t\t<option value=\"individual\">individual</option>\n\t\t<option value=\"shared\">shared</option>\n\t   </select>\n\t  </div>\n\t  <div class=\"form-group\">\n\t   <label>Amount</label>\n\t   <input type=\"text\" inputmode=\"numeric\" pattern=\"\\d*\" id=\"xp-amount\">\n\t  </div>\n\t </form>\n\t `,\n\t\tbuttons: {\n\t\t\tone: {\n\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\n\t\t\t\tlabel: \"Confirm\",\n\t\t\t\tcallback: (html) => {\n\t\t\t\t\tlet type = html.find('[id=xp-type]')[0].value;\n\t\t\t\t\tlet amount = parseInt(html.find('[id=xp-amount]')[0].value);\n\t\t\t\t\taward_xp(type, amount);\n\t\t\t\t}\n\t\t\t},\n\t\t\ttwo: {\n\t\t\t\ticon: '<i class=\"fas fa-times\"></i>',\n\t\t\t\tlabel: \"Cancel\",\n\t\t\t}\n\t\t},\n\t\tdefault: \"Cancel\"\n\t}).render(true);\n})();","author":"X4uo406iXTm4HkVN","img":"icons/commodities/treasure/crown-gold-laurel-wreath.webp","actorIds":[],"_id":"4ztfFybueGn0WH2h"}
{"_id":"552KAqxFAXxyfz3o","name":"Enable AutoRotate","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"(async function(){\n  let content = `\n    <form><div class=\"form-group\">\n      <label>Enable/Disable Autorotation for All Tokens:</label>\n      <input type=\"checkbox\" id=\"ar-enabled\" value=\"0\">\n    </div></form>\n  `;\n\n  async function apply(html){\n    let checked = html.find('#ar-enabled').is(':checked');\n    console.log(`Setting autorotate.enabled flag to ${checked}`);\n\n    for (let actor of game.actors){\n      console.log({actor});\n      console.log({'actor.data.token': actor.data.token});\n      await actor.update({'data.token.flags.autorotate.enabled': checked});\n    }\n\n    for (let scene of game.scenes){\n      await scene.view();\n      for (let token of canvas.tokens.placeables){\n        console.log({token});\n        token.setFlag('autorotate', 'enabled', checked);\n      }\n    }\n\n    console.log('Finished.');\n  }\n\n  new Dialog({\n    content: content,\n    buttons: {\n      apply: {\n        label: \"Apply\",\n        callback: async (html) => {\n          try {\n            apply(html);\n            ui.notifications.info(\"Success\");\n          } catch {\n            ui.notifications.error(\"Error. Check console (F12).\");\n          }\n        }\n      },\n      cancel: {\n        label: \"Cancel\",\n      }\n    }\n  }).render(true);\n\n}())","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"7vbvu4hjJ9wNUPhe","name":"DAEAttackEnd","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"// @token @target @item|itemName\n//console.log(\"ON ATACK\", args);\nif(args[0] == \"off\"){\n    let atoken = canvas.tokens.get(args[1]);\n    let atarget = canvas.tokens.get(args[2]);\n    let saveTargets = game.user.targets;\n    let damageItem = (typeof args[3] === 'string') ? atoken.actor.items.find(i => i.name === args[3]) : atoken.actor.items.find(i => i.id === args[3]._id);\n        game.user.targets = new Set([atarget]);\n        try {\n            damageItem.roll();\n        } finally {\n            game.user.targets = saveTargets;\n        }\n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/violet_20.jpg","actorIds":[]}
{"name":"Mirror Image","permission":{"default":0,"0gq993wckhGZNbNh":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Mirror Image\");","author":"0gq993wckhGZNbNh","img":"modules/plutonium/media/icon/spell/phb-mirror-image.jpg","actorIds":[],"_id":"9dXGwbyHbWxDkpi4"}
{"name":"Update tokens to Actor","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":1300001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_12ta9h39ac1","path":"Amostras#/CF_SEP/Generators","color":"#000000","import":true}},"scope":"global","command":"(async () => {\n  let updates = canvas.scene.data.tokens.map(t => {\n    let tactor = game.actors.entities.find(a => a.name === t.name);\n        if (tactor) {\n            return {\n                _id: t._id,\n                actorId: tactor.id\n            }\n        } else {\n            console.log(t.name);\n            return {\n                _id: t._id,\n                actorId: \"\"\n            }\n        }\n  });\n  await canvas.scene.updateEmbeddedEntity(\"Token\", updates);\n})();","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"A4piUX43KizO2GNN"}
{"_id":"Bq4bKFi0ckbRIptW","name":"PoolCheck","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2900001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"//console.log(args);\nlet pool = new Innocenti.PoolCheck(game.user,token);\npool.Check(...args);","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"name":"EncouterScene","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2500001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"//args[0] = 10;\n//args[1] = game.scenes.active.name;\nlet encounter = new InnocentiEncounters.Encounters();\nawait encounter.RegistryEncounter(args[0],args[1]);\nawait encounter.RollTable(args[1]);\nawait console.log(encounter);","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"CqD8FcEGc0Gd5i6f"}
{"name":"RollTable: Research Complications","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4400001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/d20-grey.svg","tooltip":"RollTable: Research Complications","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_njjj4vlgt8n","path":"Roll Tables","color":"#008000","import":true}},"scope":"global","command":"game.tables.getName(\"Research Complications\").draw();","author":"X4uo406iXTm4HkVN","img":"icons/sundries/books/book-embossed-gold-red.webp","actorIds":[],"_id":"DA589ck1MHnENFSl"}
{"_id":"EKHH481QETUeEdXS","name":"DAERepeat","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"//DAERepeat @token @target itemName\nif(args[0] === 'each'){\n    console.log(\"EACH\", args);\n    let atoken = canvas.tokens.get(args[1]);\n    let atarget = canvas.tokens.get(args[2]);\n    let saveTargets = game.user.targets;\n    let damageItem = atoken.actor.items.getName(args[3]);\n    let aCondition = damageItem.data.data.activation.condition;\n    \n    if(aCondition && game.cub.hasCondition(aCondition, atarget)){\n        await atoken.actor.deleteEmbeddedEntity(\"ActiveEffect\", effectId);\n        return;\n    }\n    game.user.targets = new Set([atarget]);\n    try {\n        damageItem.roll();\n    } finally {\n        game.user.targets = saveTargets;\n    }\n}","author":"X4uo406iXTm4HkVN","img":"assets/icons/icones-flat/Icon.4_03.png","actorIds":[]}
{"name":"Looting","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"Qu7E86Xi2q9u0u1z":3},"type":"script","sort":100001,"flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.xF8VDI28j7UzkSoG"}},"scope":"global","command":"(async () => {\nlet actions = new InnocentiLoot.Loot();\nawait actions.Check();\n})();","author":"Qu7E86Xi2q9u0u1z","img":"icons/containers/bags/coinpouch-gold-red.webp","actorIds":[],"_id":"Em1uEpmWRzUceqKy"}
{"name":"05 - Glow","permission":{"default":0,"Njc5YzFjZDI5NjZl":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":5100001,"flags":{"furnace":{"runAsGM":false}},"scope":"global","command":"let params =\r\n[{\r\n    filterType: \"glow\",\r\n    filterId: \"superSpookyGlow\",\r\n    outerStrength: 4,\r\n    innerStrength: 0,\r\n    color: 0x5099DD,\r\n    quality: 0.5,\r\n    padding: 10,\r\n    animated:\r\n    {\r\n        color: \r\n        {\r\n           active: true, \r\n           loopDuration: 3000, \r\n           animType: \"colorOscillation\", \r\n           val1:0x5099DD, \r\n           val2:0x90EEFF\r\n        }\r\n    }\r\n}];\r\n\r\nTokenMagic.addUpdateFiltersOnSelected(params);","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"EmTnn1zXl1F8CuM0"}
{"_id":"FtMpNCayZFUKfjWE","name":"Update Unlinked Tokens to Actors","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"(async () => {\n    let aName = \"Commoner\";\n    let tactor = game.actors.getName(aName);\n    let tokens = canvas.tokens.controlled;\n    for (var tok of canvas.tokens.controlled) {\n        tok.update({actorId: tactor._id})\n       console.log(tok)\n    }\n    \n})();","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"G5Oa7uYTIGmHWk22","name":"Update Cite Journal","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":1100001,"flags":{"furnace":{"runAsGM":false},"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"Update Cite Journal","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_12ta9h39ac1","path":"Amostras#/CF_SEP/Generators","color":"#000000","import":true}},"scope":"global","command":"const actorNames = game.actors.map(actor => actor.name).filter((value, index, self) => self.indexOf(value) === index);\nconst journalNames = game.journal.map(journal => journal.name).filter((value, index, self) => self.indexOf(value) === index);\n\nconst indexCite = {\n    Actor: actorNames,\n    JournalEntry: journalNames\n    }\n\ngame.journal.forEach(entry => {\n    //console.log(entry.entity)\n    if(entry.folder !== null && entry.folder.name !== \"UPDATE\") return;\n    let newcontent = entry.data.content;\n    for(const [key, value] of Object.entries(indexCite)){\n        let entityType = key;\n        for (let i = 0; i < value.length; i++) {\n            let strName = value[i];\n            let str = `(?!\\\\[)\\\\b${strName}\\\\b(?![\\\\w\\\\s]*[\\\\]\\\\}])`;\n            //let str = `\\\\b${strName}(?=[^\\\\}\\\\]\\\\w])`;\n            let regEx = new RegExp(str, 'g');\n            if(value[i] != entry.name){\n                //console.log(regEx);\n                if(newcontent == null) return;\n                newcontent = newcontent.replace(regEx, `@${entityType}[${value[i]}]{${value[i]}}`);\n            }else{\n               newcontent = newcontent.replace(regEx, `<strong>${value[i]}</strong>`); \n            }\n        }\n        //console.log(newcontent);\n        entry.update({ content: newcontent });\n    }\n    //console.log(newcontent);\nui.notifications.info(\"Atualizou as citações nos journals\")\n    console.log(\"FIM\");\n});\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"I8qhxvcKwr7IkA2v","name":"Update Tokens Weapons MidiMacro","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":300001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.7KWn7kV8paHkY2XC"},"cf":{"id":"temp_49cgjf7ubog","path":"Amostras","color":"#000000","import":true}},"scope":"global","command":"let macroname = \"AutoRollTableCriticalHit\";\n\n(async () => {\n    canvas.tokens.placeables.map(a => {\n        if(!a.actor) return console.log(a.name)\n        a.actor.items.map(b => {\n            if (b.type === 'weapon' && (b.data.data.actionType === 'mwak' || b.data.data.actionType ==='rwak' || b.data.data.actionType ==='msak' || b.data.data.actionType ==='rsak')) {\n                console.log(b.name)\n                b.setFlag('midi-qol','onUseMacroName', macroname);\n            }\n        })\n    })\nconsole.log(\"Fim - Tokens On Map\")\n})();","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"name":"Eldritch Blast","permission":{"default":0,"0gq993wckhGZNbNh":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Eldritch Blast\");","author":"0gq993wckhGZNbNh","img":"modules/plutonium/media/icon/spell/phb-eldritch-blast.jpg","actorIds":[],"_id":"JgTfeBpYLqwxzVz7"}
{"name":"Edit Biografy in Compendium","permission":{"default":0,"hfVBUA9x0nVqLlXX":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4700001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"let packname = \"innocenti-worlds.npcs\";\r\nlet pack = game.packs.get(packname);\r\nlet cpack = await pack.getContent();\r\ngame.actors.forEach(entry => {\r\nlet bio = entry.data.data.details.biography;\r\nlet matches = bio.value.replace(/mod-my-world/g, 'innocenti-worlds');\r\n//console.log(matches );\r\nentry.update({ 'data.details.biography.value' : matches }); \r\n})\r\nconsole.log(\"FIM\");","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"K9okgECPH1RIpySN"}
{"name":"EnlargeReduce","permission":{"default":0,"XE30TcnpPFgl2g1S":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":5000001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.tKKbvoCkf5A37rsc"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target \n\n/**\n * For each target, the GM will have to choose \n */\nlet target = canvas.tokens.get(args[1]);\nlet originalSize = target.data.width;\nlet mwak = target.actor.data.data.bonuses.mwak.damage;\n\nif (args[0] === \"on\") {\n    new Dialog({\n        title: \"Enlarge or Reduce\",\n        buttons: {\n            one: {\n                label: \"Enlarge\",\n                callback: () => {\n                    let bonus = mwak + \" 1d4\";\n                    let enlarge = (originalSize + 1);\n                    target.actor.update({ \"data.bonuses.mwak.damage\": bonus });\n                    target.update({ \"width\": enlarge, \"height\": enlarge });\n                    target.actor.setFlag('world', 'enlageReduceSpell', {\n                        size: originalSize,\n                        ogMwak: mwak,\n                    });\n                    ChatMessage.create({ content: target.name + \" is enlarged\" });\n                }\n            },\n            two: {\n                label: \"Reduce\",\n                callback: () => {\n                    let bonus = mwak + \" -1d4\";\n                    let size = originalSize;\n                    let newSize = (size > 1) ? (size - 1) : (size - 0.3);\n                    target.actor.update({ \"data.bonuses.mwak.damage\": bonus });\n                    target.update({ \"width\": newSize, \"height\": newSize });\n                    target.actor.setFlag('world', 'enlageReduceSpell', {\n                        size: originalSize,\n                        ogMwak: mwak,\n                    });\n                    ChatMessage.create({ content: target.name + \" is reduced\" });\n                }\n            },\n        }\n    }).render(true);\n}\nif (args[0] === \"off\") {\n    let flag = target.actor.getFlag('world', 'enlageReduceSpell');\n    target.actor.update({ \"data.bonuses.mwak.damage\": flag.ogMwak });\n    target.update({ \"width\": flag.size, \"height\": flag.size });\n    target.actor.unsetFlag('world', 'enlageReduceSpell');\n    ChatMessage.create({ content: target.name + \" is returned to normal size\" });\n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/spells/link-blue-2.jpg","actorIds":[],"_id":"KaX1jDn2tYOfisX9"}
{"_id":"KsUQi9DGzcV4sFWJ","name":"EncouterActiveScene","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":3600001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"cf":{"id":"temp_tu9ff6ho8z","path":"Players Macros#/CF_SEP/Macro GM","color":"#004040","import":true}},"scope":"global","command":"//args[0] = 10;\nif(!args[1])\n    args[1] = `Encounter ${game.scenes.active.name}`;\nlet encounter = new InnocentiEncounters.Encounters();\n\nif(args[0])\n    await encounter.RegistryEncounter(args[0],args[1]);\nawait encounter.RollTable(args[1]);\nawait console.log(encounter);","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/yellow_20.jpg","actorIds":[]}
{"name":"RollTable: Erro Crítico","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4200001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/d20-grey.svg","tooltip":"RollTable: Erro Critico","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_njjj4vlgt8n","path":"Roll Tables","color":"#008000","import":true}},"scope":"global","command":"game.tables.getName(\"Erro Crítico\").draw();","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-black.svg","actorIds":[],"_id":"L7n49X9JcNUbrZtW"}
{"_id":"M0YV8OjQ6iTqqQhi","name":"Create Tables By Rarity","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":700001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"Create Tables By Rarity ","colour":"#ff0000","trigger":""}},"cf":{"id":"temp_12ta9h39ac1","path":"Amostras#/CF_SEP/Generators","color":"#000000","import":true}},"scope":"global","command":"game.betterTables.createTableFromCompendium(\"Sub Table Spells Cicle 9\",\n    //\"dnd5e.items\",\n    //\"innocenti-worlds.item-recipes\",\n    \"dnd5e.spells\",\n    { weightPredicate: predicate }\n);\n\nfunction predicate(entity) {\n    //if(entity.type != \"loot\") return 0;\n    if(entity.data.data.level != 9) return 0;\n    //if(entity.data.data.consumableType != \"food\") return 0;\n    //if(entity.data.data.rarity != \"Legendary\") return 0;\n    //if(entity.data.data.price != 1000) return 0;\n    /*\n    switch (entity.data.data.rarity) {\n        case \"Common\":\n            return 16;\n        case \"Uncommon\":\n            return 8;\n        case \"Rare\":\n            return 4;\n        case \"Very rare\":\n            return 2;\n        case \"Legendary\":\n            return 1;\n        default:\n            return 0;\n    }\n*/\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"name":"RollTable: Acerto Crítico","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4000001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/d20-grey.svg","tooltip":"RollTable: Acerto Crítico","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_njjj4vlgt8n","path":"Roll Tables","color":"#008000","import":true}},"scope":"global","command":"game.tables.getName(\"Acerto Crítico\").draw();","author":"X4uo406iXTm4HkVN","img":"icons/vtt-512.png","actorIds":[],"_id":"MOe1FJXsBRdeYjPc"}
{"name":"RollTable: Orientation","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4300001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/d20-grey.svg","tooltip":"RollTable: Orientation","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_njjj4vlgt8n","path":"Roll Tables","color":"#008000","import":true}},"scope":"global","command":"game.tables.getName(\"Orientation\").draw();","author":"X4uo406iXTm4HkVN","img":"icons/tools/navigation/compass-brass-blue-red.webp","actorIds":[],"_id":"MVwPi9uuPlNjQzuP"}
{"_id":"PFOHQ9L9WVm5TnVq","name":"DAEAura","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"// DAEAura @token @item self\nconsole.log(args);\nlet atoken = canvas.tokens.get(args[1]);\nlet lastArg = args[args.length-1];\nlet effectId = lastArg.effectId;\nlet atarget=[];\nlet self = (args[3]!== lastArg && args[3] == 'self') ? true : false;\nif(args[0] === 'on' || args[0] === 'each'){\n    if(self && atoken.actor.id != lastArg.actorId) return;\n    canvas.tokens.placeables.map(entity=>{\n        entity.actor.effects.map(ef=>{\n            if(ef.data.origin == lastArg.origin && ef.data.label == lastArg.efData.label){\n                if(entity.actor.id == lastArg.actorId && self){\n                    atarget.push(entity);\n                }else if(entity.actor.id != lastArg.actorId){\n                    atarget.push(entity);\n                }\n            }\n        });\n    });\n    console.log(atoken, atarget);\n    let saveTargets = game.user.targets;\n        game.user.targets = new Set(atarget);\n        try {\n            let damageItem = (typeof args[2] === 'string') ? atoken.actor.items.find(i => i.name === args[2]) : atoken.actor.items.find(i => i.id === args[2]._id);\n            console.log(damageItem);\n            damageItem.roll();\n        } finally {\n            game.user.targets = saveTargets;\n        }\n    \n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/spells/wind-grasp-magenta-2.jpg","actorIds":[]}
{"_id":"TCH1Rrww1uloXDbx","name":"asdasd","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"asdasdasdasd","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"TvGtSTrUEhBD42VO","name":"Passive","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2800001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"//args[0] = dificult\n//args[1] = sucess\n//args[2] = fail\n//args[3] = flags\n//console.log(token.id,game.user.id,args);\n//console.log(args);\nlet checks = new Innocenti.PassiveCheck(game.user,token);\nchecks.Check(...args);","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"name":"Invisibility","permission":{"default":0,"XE30TcnpPFgl2g1S":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4900001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target\n\nlet target = canvas.tokens.get(args[1])\nif (args[0] === \"on\") {\n    ChatMessage.create({ content: `${target.name} turns invisible` });\n    target.update({ \"hidden\": true });\n}\nif (args[0] === \"off\") {\n    ChatMessage.create({ content: `${target.name} re-appears` });\n    target.update({ \"hidden\": false });\n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/spells/fog-sky-2.jpg","actorIds":[],"_id":"U2ZtuhZLR0hNmCYC"}
{"_id":"U3Uun3hzQEMDpukd","name":"RepeatTest","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"//console.log(\"ENTRA\", args);\n// \"RepeatTest\" str dc condition @token @target\nlet ttoken = canvas.tokens.get(args[4]);\nlet atargets = canvas.tokens.get(args[5]);\nlet tactor = atargets.actor;\nlet dc = args[2];\nlet skill = args[1];\nlet cond = args[3];\nlet lastArg = args[args.length-1];\nlet effectId = lastArg.effectId;\nif (args[0] === \"each\") {\n    if (Object.entries(game.dnd5e.config.skills).map(a => a[0]).includes(skill)){\n        tactor.rollSkill(skill).then((result) => {\n            if (result.total >= dc) {\n                atargets.actor.deleteEmbeddedEntity(\"ActiveEffect\", effectId);\n            }\n        });\n    }else if (Object.entries(game.dnd5e.config.abilities).map(a => a[0]).includes(skill)){\n        tactor.rollAbilityTest(skill).then((result) => {\n            if (result.total >= dc) {\n                atargets.actor.deleteEmbeddedEntity(\"ActiveEffect\", effectId);\n            }\n        });\n    }\n    \n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/blue_01.jpg","actorIds":[]}
{"_id":"U5jB54MuStm9TWeu","name":"Find Trap","permission":{"default":2,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":1700001,"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.4MODdS79QhACoEd9"},"furnace":{"runAsGM":false},"cf":{"id":"temp_3qd5z0dngmj","path":"Automação","color":"#0080c0","import":true}},"scope":"global","command":"let actions = new InnocentiOpenLock.Actions('FindLockTrap');","author":"X4uo406iXTm4HkVN","img":"icons/tools/scribal/magnifying-glass.webp","actorIds":[]}
{"_id":"URCysq091tZyoQh2","name":"DAE Life Drain","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"console.log(args);\nlet adamage = args[1];\nlet atarget = canvas.tokens.get(args[2]);\n\nif (args[0] === \"on\") {\n    let max = atarget.actor.data.data.attributes.hp.max - (adamage);\n    console.log(\"Drena\", max);\n    atarget.actor.update ({\n        \"data.attributes.hp.max\": max\n    });\n}\nif (args[0] === \"off\") {\n    let max = atarget.actor.data.data.attributes.hp.max + (adamage);\n    atarget.actor.update ({\n        \"data.attributes.hp.max\": max\n    });\n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/violet_28.jpg","actorIds":[]}
{"name":"Fix Journals (change compendium links)","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":900001,"flags":{"furnace":{"runAsGM":true},"cf":{"id":"temp_12ta9h39ac1","path":"Amostras#/CF_SEP/Generators","color":"#000000","import":true}},"scope":"global","command":"//TROCA OS LINKS DE COMPENDIUM PARA LINKS DO MUNDO.\r\n// COM ECXESSÃO DOS ITEMS QUE MANTÉM NO COMPENDIUM\r\nlet count = 0;\r\ngame.journal.forEach(entry => {\r\n    let content = entry.data.content;\r\n    let matches = content.match(/@\\w*\\[([0-9A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ.\\- ]+)\\]?(\\{([0-9A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ;&.\"()\\- ]+)\\})/g);\r\n\r\n    // now we have an array of things such as @Actor[5c8HWfrpvRV4XtZ1]\r\n    if (matches == null) return;\r\n    let newcontent = content;\r\n    \r\n    let uniqueMatches = matches\r\n        .filter((value, index, self) => self.indexOf(value) === index) //unique matches\r\n        .forEach(str => {\r\n            count++;\r\n            let firstdata = str.slice(0, -1).split('{');\r\n            let pName = firstdata[1];\r\n            //console.log(firstdata);\r\n            let arrayData = firstdata[0].slice(1, -1).split('['); // cut off the @ and ] then make [0] the type and [1] the id.\r\n            // since the reference may not match directly with the game entity type, lets look that up.\r\n            //console.log(arrayData, pName)\r\n            if (arrayData[0] != 'Compendium') return;\r\n            let pck = arrayData[1].split('.');\r\n            let packname = `${pck[0]}.${pck[1]}`;\r\n            //console.log(packname);\r\n            let id = pck[2];\r\n            let entityType = getEntityType(arrayData[0]);\r\n            \r\n            // with the id and our entity type, look up the name of the entry.\r\n            let packs = game[entityType].get(packname);\r\n            \r\n            if(packs == null){ return console.log(`Não Existe Um compendium com o nome: ${packname} com o item ${entry.name}`)}\r\n            let newEntity = packs.entity;\r\n            //console.log(newEntity);\r\n            if (newEntity === 'Item') return;\r\n            let pindex = packs.index.find(element => element._id === id) || packs.index.find(element => element.name === pName);\r\n            \r\n            if (!pindex) {\r\n                //console.log(packs.index.find(element => element.name == pName), pName, newEntity, packname);\r\n                //return ui.notifications.error(`Could not find any record for the entity type ${entityType} in pack ${packs} with the id of ${id}`);\r\n            }\r\n            let name = (pindex) ? pindex.name : htmlDecode(pName);\r\n            console.log(name);\r\n\r\n            if (!name) {\r\n                return ui.notifications.error(`Could not find any record for the entity type ${entityType} with the id of ${arrayData[0]}`);\r\n            }\r\n            let changeEntry = (name !== '') ? `@${packs.entity}[${name}]` : '';\r\n            //console.log(changeEntry);\r\n            let newstr = escapeRegExp(firstdata[0]);\r\n            console.log(`updating ${id} with ${name}`);\r\n            let regEx = new RegExp(newstr, 'g');\r\n            //console.log(regEx);\r\n            newcontent = newcontent.replace(regEx, changeEntry);\r\n            //console.log(newcontent);\r\n        });\r\n    entry.update({ content: newcontent });\r\n});\r\nconsole.log(count);\r\n\r\nfunction escapeRegExp(string) {\r\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\r\n}\r\nfunction getEntityType(entity) {\r\n    switch (entity) {\r\n        case 'JournalEntry': return 'journal';\r\n        case 'RollTable': return 'tables';\r\n        case 'Compendium': return 'packs';\r\n        default: return entity.toLowerCase() + 's';\r\n    }\r\n}\r\n\r\nfunction htmlDecode(input) {\r\n  var doc = new DOMParser().parseFromString(input, \"text/html\");\r\n  return doc.documentElement.textContent;\r\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"UkgewqKnBnAfEegJ"}
{"_id":"VuPsaCpqWXPnBcmc","name":"DAEAttack","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"// DAEAttack @token @target @item|itemName\nconsole.log(\"ON ATACK\", args);\nif(args[0] == \"on\" || args[0] == \"each\"){\n    let atoken = canvas.tokens.get(args[1]);\n    let atarget = canvas.tokens.get(args[2]);\n    let saveTargets = game.user.targets;\n    let damageItem = (typeof args[3] === 'string') ? atoken.actor.items.find(i => i.name === args[3]) : atoken.actor.items.find(i => i.id === args[3]._id);\n        game.user.targets = new Set([atarget]);\n        try {\n            damageItem.roll();\n        } finally {\n            game.user.targets = saveTargets;\n        }\n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/weapon_23.jpg","actorIds":[]}
{"_id":"WNfZoIc5jjGa9P8q","name":"RemoveItemToken","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"(async () => {\n    let aName = \"Gold 1d10 (gp)\";\n\n    for (var tok of canvas.tokens.controlled) {\n        let loot = tok.actor.data.items.filter(i => i.type === \"loot\");\n        let item = loot.find(i => i.name === \"Gold 1d10 (gp)\");\n        if(item._id);\n        await tok.actor.deleteEmbeddedEntity(\"OwnedItem\", item._id);\n        //await tok.actor.deleteEmbeddedEntity(\"OwnedItem\", deletions);\n       console.log(tok);\n    }\n    \n})();","author":"X4uo406iXTm4HkVN","img":"icons/svg/chest.svg","actorIds":[]}
{"name":"Hellish Rebuke","permission":{"default":0,"0gq993wckhGZNbNh":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Hellish Rebuke\");","author":"0gq993wckhGZNbNh","img":"modules/plutonium/media/icon/spell/phb-hellish-rebuke.jpg","actorIds":[],"_id":"VfqNIgYIaPqc0UeV"}
{"_id":"XOkd56MES7LUe5uV","name":"RepeatDamage","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"//RepeatDamage @token @target @item | NameItem [itemToken]\nif(args[1] == null){\n    let atarget=[];\n    //Magia veio de uma Aura\n    let org = args[args.length -1].origin.split('.');\n    let aactor = game.actors.get(org[1]);\n    if(canvas.tokens.get(args[args.length -1].tokenId).actor.id == aactor.id){\n        canvas.tokens.placeables.map(entity=>{\n            if(entity.actor.id != aactor.id){\n                entity.actor.effects.map(ef=>{\n                    if(ef.data.origin == args[args.length -1].origin && ef.data.label == args[args.length -1].efData.label){\n                        atarget.push(entity)\n                        console.log(\"Alvo é : \", entity.name, ef.data.label);\n                    }\n                });\n            }\n        });\n        let saveTargets = game.user.targets;\n        game.user.targets = new Set(atarget);\n        try {\n            let damageItem = aactor.items.get(org[3]);\n            damageItem.roll();\n        } finally {\n            game.user.targets = saveTargets;\n        }\n    }\n}else{\n    if(args[0] === 'each'){\n        let atoken = canvas.tokens.get(args[1]);\n        let atarget = canvas.tokens.get(args[2]);\n        let damageItem = (args[3].id) ? atoken.actor.items.get(args[3]._id) : atoken.actor.items.getName(args[3]);\n        let saveTargets = game.user.targets;\n        game.user.targets = new Set([atarget]);\n        try {\n           await damageItem.roll();\n           if(args[4]){\n               game.user.targets = new Set([atoken]);\n           }\n        } finally {\n            game.user.targets = saveTargets;\n        }\n    }\n    //console.log(args)\n}","author":"X4uo406iXTm4HkVN","img":"assets/icons/icones-flat/Icon.4_03.png","actorIds":[]}
{"_id":"XQ4UWo1Yx6H05dJZ","name":"GiveItemToken","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"(async () => {\n    let aName = \"Table: Treasure 0-4\";\n    \n    let item = game.items.getName(aName);\n\n    for (var tok of canvas.tokens.controlled) {\n        await tok.actor.createEmbeddedEntity(\"OwnedItem\", item, { noHook: true });\n       console.log(tok)\n    }\n    \n})();","author":"X4uo406iXTm4HkVN","img":"icons/svg/chest.svg","actorIds":[]}
{"name":"LongRest","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2600001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"LongRest","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"if(args[0] == \"off\"){\nlet status = InnocentiReset.LongRest(args[1]);\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/sleep.svg","actorIds":[],"_id":"YHoRnB0ABBKAPej9"}
{"name":"00 - A - Delete filters on Selected","permission":{"default":0,"Njc5YzFjZDI5NjZl":3,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{},"scope":"global","command":"// Delete all filters on the selected tokens/tiles\nTokenMagic.deleteFiltersOnSelected();","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"arnKdsdlJKvyKB8D"}
{"_id":"bWE1LngopE0iiYPP","name":"Checks","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2400001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"//args[0] = skill\n//args[1] = dificult\n//args[2] = sucess\n//args[3] = fail\n//args[4] = flags\n//console.log(token.id,game.user.id,args);\nconsole.log(args);\nlet checks = new Innocenti.Checks(game.user,token);\nchecks.Check(...args);","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"bZz9qhpjArvoRdWq","name":"Reoccuring Effect","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"exportSource":{"world":"testWorld","system":"dnd5e","coreVersion":"0.7.9","systemVersion":"1.2.4"}},"scope":"global","command":"// arguments\n//args[0] --> \"on\", \"each\", \"off\"\n//args[1] --> the level the spell was cast (usually @item.level)\n//args[2] --> save allowed (\"yes\"/\"no\"), e.g. damage effects that can only be ended using an action)\n//args[3] --> damage mode \n//              \"none\" for effects without damage\n//              \"flat\" for fixed damage from argument baseDamage\n//              \"scaling\" for damage scaling based on castLevel\n//args[4] --> damage type\n//args[5] --> baseDamage (e.g. 1d6)\n//args[6] --> scalingDieCount (e.g. 2 for 2dX scaling per spell level)\n//args[7] --> scalingDieSize (e.g. d6 for Xd6 scaling per spell level)\n//args[8] --> saveType (if spell does not contain a saving throw, e.g. Paladin smites)\n//args[9] --> flat DC\n\nif (args[0] === \"each\") {\n\n  const lastArg = args[args.length-1];\n  const castLevel = args[1];\n  const saveAllowed = args[2];\n  const damageMode = args[3];\n  const damageType = args[4];\n  const baseDamage = args[5];\n  const scalingDieCount = args[6];\n  const scalingDieSize = args[7];\n  let saveType = args[8];\n  let dc = args[9];\n\n  let target;\n  if (lastArg.tokenId) target = canvas.tokens.get(lastArg.tokenId);\n    else target = game.actors.get(lastArg.actorId).getActiveTokens(0);\n  const effect = lastArg.effectId;\n  const casterItem = lastArg.efData.flags.dae.itemData;\n  const casterItemLevel = casterItem.data.level;\n  const [_1, casterId, _2, _3] = lastArg.efData.origin.split(\".\")\n  const caster = game.actors.get(casterId);\n  const casterT = caster.isToken ? caster.token : caster.getActiveTokens[0];\n\n  let effectEnds;\n  \n  //Determine saveType and dc if save is allowed and ask for save\n  //Priority for save: 1) values in args[8] and args[9]\n  //          2) values stored in the item\n  if (saveAllowed === \"yes\") {\n      if (saveType === null) {\nChatMessage.create({ content: \"Hallo\" });   \n        saveType = casterItem.data.save.ability;\n        dc = casterItem.data.save.dc;\n      }\n      const flavor = `${CONFIG.DND5E.abilities[saveType]} DC${dc} ${casterItem.name}`;  \n      let save = (await target.actor.rollAbilitySave(saveType, {flavor, fastforward: true, chatMessage: true}));\n      if (save.total >= dc) effectEnds = true;\n        else effectEnds = false;\n  } else effectEnds = false;\n\n\n  //Delete effect if saved; otherwise do damage, if effect has damage over time\n  if (effectEnds) {\n    if (target) target.actor.deleteEmbeddedEntity(\"ActiveEffect\", effect);\n  } else {\n    let damageRoll;\n    if (damageMode != \"none\") {\n      let damageFormula;\n      if (damageMode === \"scaling\" && castLevel-casterItemLevel > 0) {\n        damageFormula = baseDamage + \"+\" + (castLevel-casterItemLevel) * scalingDieCount + scalingDieSize;\n      } else {\n        damageFormula = baseDamage;\n      }\n      damageRoll = new Roll(damageFormula).roll();\n      new MidiQOL.DamageOnlyWorkflow(caster, casterT, damageRoll.total, damageType, [target], damageRoll, {flavor: `Damage for ${casterItem.name}`, itemCardId: \"new\", itemData: casterItem})\n    }\n  }\n}","author":"iv1xD7Xolui8SRLL","img":"systems/dnd5e/icons/skills/affliction_02.jpg","actorIds":[]}
{"name":"Ray of Enfeeblement","permission":{"default":0,"0gq993wckhGZNbNh":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Ray of Enfeeblement\");","author":"0gq993wckhGZNbNh","img":"modules/plutonium/media/icon/spell/phb-ray-of-enfeeblement.jpg","actorIds":[],"_id":"d74b9zH3MwBtG2R0"}
{"name":"UpdateTempHP","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":3100001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"let target = canvas.tokens.get(args[1]);\nif (!target) {\n  ChatMessage.create({content: `Token ${args[1]} is no longer in scene`, whisper: ChatMessage.getWhisperIDs(\"GM\")})\n  return;\n}\nlet increment = args[2];\nlet temphpMax = (target.actor.data.data.attributes.hp.tempmax < increment)? increment:target.actor.data.data.attributes.hp.tempmax;\nlet temphp = (target.actor.data.data.attributes.hp.tempmax < increment)? increment:target.actor.data.data.attributes.hp.temp;\n\nif (args[0] === \"on\") {\n  target.actor.update({\"data.attributes.hp.tempmax\": temphpMax, \"data.attributes.hp.temp\": temphp})\nChatMessage.create({content: `Meal: ${target.name} received ${increment} HP temp`})\n} else {\n  target.actor.update({\"data.attributes.hp.tempmax\": 0, \"data.attributes.hp.temp\": 0})\nChatMessage.create({content: `Meal Expiry: ${target.name} Temp HP reduced by 0`})\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"fJCHyy6URib7zDKF"}
{"name":"Give Money","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":1800001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_3qd5z0dngmj","path":"Automação","color":"#0080c0","import":true}},"scope":"global","command":"//Money Give/Remover\n\n(() => {\n\tlet targets = game.user.targets;\n\n\tlet targets_content = ``;\n\n\tfor (let target of targets) {\n\t\ttargets_content += `<img src=${target.data.img} width=\"50\" height=\"50\">`\n\t}\n\n\tlet dialog_content = `\n\t<div class = \"form-group\">\n\t\t<h1><img src=\"icons/commodities/currency/coins-plain-stack-gold.webp\" width=\"50px\" /> Golden Share</h1>\n\t\t<table style=\"width: 100%; text-align:center; border: 1px solid black\">\n\t\t  <tr>\n\t\t\t<thcolspan=\"2\">${targets_content}</th>\n\t\t  </tr>\n\t\t  <tr>\n\t\t\t<td><label for=\"pp\">Platnium<label></td>\n\t\t\t<td><input name=\"pp\" type =\"number\" value=\"0\" min=\"-999\" max=\"999\"></td>\n\t\t  </tr>\n\t\t  <tr>\n\t\t\t<td><label for=\"gp\">Gold    <label></td>\n\t\t\t<td><input name=\"gp\" type =\"number\" value=\"0\" min=\"-999\" max=\"999\"></td>\n\t\t  </tr>\n\t\t  <tr>\n\t\t\t<td><label for=\"ep\">Electrum<label></td>\n\t\t\t<td><input name=\"ep\" type =\"number\" value=\"0\" min=\"-999\" max=\"999\"></td>\n\t\t  </tr>\n\t\t  <tr>\n\t\t\t<td><label for=\"sp\">Silver  <label></td>\n\t\t\t<td><input name=\"sp\" type =\"number\" value=\"0\" min=\"-999\" max=\"999\"></td>\n\t\t  </tr>\n\t\t  <tr>\n\t\t\t<td><label for=\"cp\">Copper  <label></td>\n\t\t\t<td><input name=\"cp\" type =\"number\" value=\"0\" min=\"-999\" max=\"999\"></td>\n\t\t  </tr>\n\t\t</table>\n\t</div>`;\n\n\tnew Dialog({\n\t\tcontent: dialog_content,\n\t\tbuttons:\n\t\t{\n\t\t\tOk: { icon: ``, label: `Change Money.`, callback: (html) => changeMoney(targets, html) }\n\t\t}\n\t}).render(true);\n})();\n\nasync function changeMoney(targets, html) {\n\tlet difference_money = {\n\t\tpp: parseInt(html.find('[name=pp]')[0].value),\n\t\tgp: parseInt(html.find('[name=gp]')[0].value),\n\t\tep: parseInt(html.find('[name=ep]')[0].value),\n\t\tsp: parseInt(html.find('[name=sp]')[0].value),\n\t\tcp: parseInt(html.find('[name=cp]')[0].value)\n\t}\n\n\t//divide update_money based on # of targets\n\tdifference_money = divideValue(difference_money, targets.size);\n\n\t//get rid of \"extra\" stuff, display all names in header\n\tlet actor_content = ``;\n\tfor (let target of targets) { actor_content += `${target.actor.name}, `; }\n\n\tlet table_content = ``;\n\tfor (let key in difference_money) {\n\t\tif (difference_money[key] !== 0)\n\t\t\ttable_content += `<tr><td>${key} :</td><td>${difference_money[key]}</td></tr>`\n\t}\n\n\tlet content = `\n\t<h2><img src=\"icons/commodities/currency/coins-plain-stack-gold.webp\" width=\"50px\" /> Add Money</h2>\n\t<table style \"width: 100%; text-align:center; border: 1px solid black\">\n\t\t<tr>\n\t\t  <th colspan=\"2\">Money Change :</th>\n\t\t</tr>\n\t\t<tr>\n\t\t  <th colspan=\"2\">${actor_content}</th>\n\t\t</tr>\n\t\t${table_content}\n\t</table>`;\n\n\tfor (let target of targets) {\n\t\tlet original_money = duplicate(target.actor.data.data.currency);\n\t\tlet update_money = changeValue(original_money, difference_money);\n\n\t\tawait target.actor.update({ \"data.currency\": update_money });\n\t}\n\n\tChatMessage.create({ content, speaker: ChatMessage._getSpeakerFromUser({ user: game.user }) })\n}\n\nfunction changeValue(Original, Difference) {\n\tlet Update = { pp: 0, gp: 0, ep: 0, sp: 0, cp: 0 };\n\n\tfor (let key in Original) {\n\t\tUpdate[key] = Original[key] + Difference[key];\n\t\tif (Update[key] < 0) {\n\t\t\tswitch (key) {\n\t\t\t\tcase \"cp\":\n\t\t\t\t\tif (Update[\"sp\"] > 0) {\n\t\t\t\t\t\tUpdate[\"cp\"] += 10;\n\t\t\t\t\t\tUpdate[\"sp\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"ep\"] > 0) {\n\t\t\t\t\t\tUpdate[\"cp\"] += 50;\n\t\t\t\t\t\tUpdate[\"ep\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"gp\"] > 0) {\n\t\t\t\t\t\tUpdate[\"cp\"] += 100;\n\t\t\t\t\t\tUpdate[\"gp\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"pp\"] > 0) {\n\t\t\t\t\t\tUpdate[\"cp\"] += 1000;\n\t\t\t\t\t\tUpdate[\"pp\"] -= 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Not enough money to do that.`);\n\t\t\t\t\t}\n\t\t\t\t\tUpdate = changeValue(Update, { pp: 0, gp: 0, ep: 0, sp: 0, cp: 0 });\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"sp\":\n\t\t\t\t\tif (Update[\"ep\"] > 0) {\n\t\t\t\t\t\tUpdate[\"sp\"] += 5;\n\t\t\t\t\t\tUpdate[\"ep\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"gp\"] > 0) {\n\t\t\t\t\t\tUpdate[\"sp\"] += 10;\n\t\t\t\t\t\tUpdate[\"gp\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"pp\"] > 0) {\n\t\t\t\t\t\tUpdate[\"sp\"] += 100;\n\t\t\t\t\t\tUpdate[\"pp\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"cp\"] > 9) {\n\t\t\t\t\t\tUpdate[\"sp\"] += 1;\n\t\t\t\t\t\tUpdate[\"cp\"] -= 10;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Not enough money to do that.`);\n\t\t\t\t\t}\n\t\t\t\t\tUpdate = changeValue(Update, { pp: 0, gp: 0, ep: 0, sp: 0, cp: 0 });\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"ep\":\n\t\t\t\t\tif (Update[\"gp\"] > 0) {\n\t\t\t\t\t\tUpdate[\"ep\"] += 2;\n\t\t\t\t\t\tUpdate[\"gp\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"pp\"] > 0) {\n\t\t\t\t\t\tUpdate[\"ep\"] += 20;\n\t\t\t\t\t\tUpdate[\"pp\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"sp\"] > 4) {\n\t\t\t\t\t\tUpdate[\"ep\"] += 1;\n\t\t\t\t\t\tUpdate[\"sp\"] -= 5;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"cp\"] > 49) {\n\t\t\t\t\t\tUpdate[\"ep\"] += 1;\n\t\t\t\t\t\tUpdate[\"cp\"] -= 50;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Not enough money to do that.`);\n\t\t\t\t\t}\n\t\t\t\t\tUpdate = changeValue(Update, { pp: 0, gp: 0, ep: 0, sp: 0, cp: 0 });\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gp\":\n\t\t\t\t\tif (Update[\"pp\"] > 0) {\n\t\t\t\t\t\tUpdate[\"gp\"] += 10;\n\t\t\t\t\t\tUpdate[\"pp\"] -= 1;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"ep\"] > 1) {\n\t\t\t\t\t\tUpdate[\"gp\"] += 1;\n\t\t\t\t\t\tUpdate[\"ep\"] -= 2;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"sp\"] > 9) {\n\t\t\t\t\t\tUpdate[\"gp\"] += 1;\n\t\t\t\t\t\tUpdate[\"sp\"] -= 10;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"cp\"] > 99) {\n\t\t\t\t\t\tUpdate[\"gp\"] += 1;\n\t\t\t\t\t\tUpdate[\"cp\"] -= 100;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Not enough money to do that.`);\n\t\t\t\t\t}\n\t\t\t\t\tUpdate = changeValue(Update, { pp: 0, gp: 0, ep: 0, sp: 0, cp: 0 });\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"pp\":\n\t\t\t\t\tif (Update[\"gp\"] > 9) {\n\t\t\t\t\t\tUpdate[\"pp\"] += 1;\n\t\t\t\t\t\tUpdate[\"gp\"] -= 10;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"ep\"] > 19) {\n\t\t\t\t\t\tUpdate[\"pp\"] += 1;\n\t\t\t\t\t\tUpdate[\"ep\"] -= 20;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"sp\"] > 99) {\n\t\t\t\t\t\tUpdate[\"pp\"] += 1;\n\t\t\t\t\t\tUpdate[\"sp\"] -= 100;\n\t\t\t\t\t}\n\t\t\t\t\telse if (Update[\"cp\"] > 999) {\n\t\t\t\t\t\tUpdate[\"pp\"] += 1;\n\t\t\t\t\t\tUpdate[\"cp\"] -= 1000;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Not enough money to do that.`);\n\t\t\t\t\t}\n\t\t\t\t\tUpdate = changeValue(Update, { pp: 0, gp: 0, ep: 0, sp: 0, cp: 0 });\n\t\t\t}\n\t\t}\n\t}\n\treturn Update;\n}\n\nfunction divideValue(Object, Value) {\n\tif (Value === 1) return Object;\n\tlet remainder = 0;\n\tlet Update = { pp: 0, gp: 0, ep: 0, sp: 0, cp: 0, remainder: 0 };\n\n\tfor (let key in Object) {\n\t\tUpdate[key] = Object[key] + remainder;\n\t\tremainder = Object[key] % Value;\n\t\tif (Update[key] > 0) Update[key] = Math.floor(Update[key] / Value);\n\t\tif (Update[key] < 0) Update[key] = Math.ceil(Update[key] / Value);\n\t\tif (remainder !== 0) {\n\t\t\tif (key === \"ep\") { remainder *= 5; }\n\t\t\telse if (key === \"gp\") { remainder *= 2; }\n\t\t\telse { remainder *= 10; }\n\t\t}\n\t}\n\tUpdate.remainder = remainder / 10;\n\treturn Update;\n}","author":"X4uo406iXTm4HkVN","img":"icons/commodities/currency/coins-plain-stack-gold.webp","actorIds":[],"_id":"gJJsWWcfENwVWmXV"}
{"_id":"hoDN1mSj4OffgPcg","name":"DAEDamage","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"let adamage = args[1];\nlet atype = args[2];\nlet atoken = canvas.tokens.get(args[3]);\nlet atarget = canvas.tokens.get(args[4]);\nlet lastArg = args[args.length-1];\nlet casterItem = lastArg.efData.flags.dae.itemData;\n\nconsole.log(atoken, atarget);\n//let aactor = game.actors.get(atoken.actor.id)\n\nif (args[0] === \"each\") {\n    let damageRoll = new Roll(adamage).roll();\n    new MidiQOL.DamageOnlyWorkflow(atoken.actor, atoken, damageRoll.total, atype, [atarget], damageRoll,{flavor: `Damage type - (${atype})`, itemCardId: \"new\", itemData: casterItem})\n    \n}","author":"X4uo406iXTm4HkVN","img":"assets/icons/icones-flat/Icon.4_85.png","actorIds":[]}
{"_id":"ieo4LNP2Ywjbj9AA","name":"DAECenterToken","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"//@token @target\nlet atoken = canvas.tokens.get(args[1]);\nlet atarget = canvas.tokens.get(args[2]);\nif(args[0] === 'on'){\n    atarget.update({x: atoken.center.x, y: atoken.center.y});\n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/yellow_34.jpg","actorIds":[]}
{"_id":"ipgDkGpZBQgy7YRl","name":"Looting","permission":{"default":2,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4500001,"flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.xF8VDI28j7UzkSoG"}},"scope":"global","command":"(async () => {\nlet actions = new InnocentiLoot.Loot();\nawait actions.Check();\n})();","author":"X4uo406iXTm4HkVN","img":"icons/containers/bags/coinpouch-gold-red.webp","actorIds":[]}
{"_id":"jJ0mZoRY6NxVnBS2","name":"DAE VampBite","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true}},"scope":"global","command":"//console.log(args);\nlet adamage = args[1];\nlet atarget = canvas.tokens.get(args[2]);\nlet itarget = canvas.tokens.get(args[3]);\n\nif (args[0] === \"on\") {\n    let max = atarget.actor.data.data.attributes.hp.max - (adamage);\n    ler recover = itarget.actor.data.data.attributes.hp.value + (adamage);\n    atarget.actor.update ({\n        \"data.attributes.hp.max\": max\n    });\n    itarget.actor.update ({\n        \"data.attributes.hp.value\": recover\n    });\n}\nif (args[0] === \"off\") {\n    let max = atarget.actor.data.data.attributes.hp.max + (adamage);\n    atarget.actor.update ({\n        \"data.attributes.hp.max\": max\n    });\n}","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/red_29.jpg","actorIds":[]}
{"name":"Thunderclap","permission":{"default":0,"0gq993wckhGZNbNh":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Thunderclap\");","author":"0gq993wckhGZNbNh","img":"modules/plutonium/media/icon/spell/xge-thunderclap.jpg","actorIds":[],"_id":"kjAkYmbJV91qBnmW"}
{"_id":"l3OXUr8zu8Or7Xxh","name":"Greapple","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"// @token @target\nlet target = game.user.targets.values().next().value;\nconsole.log(target.id, token.id, args)\n/*if(args.length > 0){\n    token = canvas.tokens.get(args[1]);\n    target = canvas.tokens.get(args[2]);\n}*/\nif(token.id != target.id){\n    //Começa o agarrão\n    let skill = (target.actor.data.data.skills.ath >= target.actor.data.data.skills.acr) ? 'ath' : 'acr';\n    token.actor.rollSkill('ath').then(async (result) => {\n        let res = await target.actor.rollSkill(skill);\n        if(result.total >= res.total){\n            game.cub.addCondition(\"Grappled\", target);\n        }else if(game.cub.getCondition(\"Grappled\", target)){\n            game.cub.removeCondition(\"Grappled\", target);\n        }\n    });\n}\n\nconsole.log(\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\");","author":"X4uo406iXTm4HkVN","img":"modules/combat-utility-belt/icons/grappled.svg","actorIds":[]}
{"name":"OpenDoor","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2700001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"//args[0] = dificult\n//args[1] = sucess\n//args[2] = fail\n//args[3] = key\n//args[4] = flags\n//console.log(token.id,game.user.id,args);\nconsole.log(args);\nlet checks = new Innocenti.OpenDoor(game.user.id,token.id);\nchecks.Check(...args);","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"nNrjg6q5YVui8tkb"}
{"name":"Edit Compendiums","permission":{"default":0,"hfVBUA9x0nVqLlXX":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4800001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"let packname = \"innocenti-worlds.handout\";\r\n//let newpackname = \"innocenti-worlds.citys\";\r\n//let oldpackname = \"mod-my-world.citys\";\r\n\r\nlet pack = game.packs.get(packname);\r\nlet cpack = await pack.getContent();\r\ncpack.forEach(entry => {\r\nlet content = entry.data.content;\r\n//let matches = content.match(/@\\w*\\[([\\w.-]+)\\]\\{([\\w.-\\s]+)\\}/g);\r\n//var newstring = content.replace(/(mod[-]my[-]world)/, \"innocenti-worlds\");\r\n//newstring = newstring.replace(\"mod-my-world.locals\", \"innocenti-worlds.locals\");\r\nlet matches = content.replace(/mod-my-world/g, 'innocenti-worlds');\r\nentry.update({ content:  matches}); \r\n})\r\n\r\nawait console.log(\"FIM\");\r\n\r\n","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"npUhWBibtiBV6maP"}
{"_id":"oTBwilFufvzOo52n","name":"SelfRepeat","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"// usado apra marcar qual inimigo vai repetir o ataque\n// SelfRepeat @token @target @item|itemName end|start\nlet atoken = canvas.tokens.get(args[1]);\nlet atarget = canvas.tokens.get(args[2]);\nlet lastArg = args[args.length-1];\nlet effectId = lastArg.effectId;\nlet macroRepeat = (args[4] && args[4] != lastArg)? 'endEveryTurn':'startEveryTurn';\n\nlet REPEAT_EFFECT = {\n    label: `Repeat_${atarget.name}`,\n    icon: \"assets/icons/icones-flat/Icon.4_03.png\",\n    changes: [\n      {key: \"macro.execute\", \n      value: `DAERepeat ${args[1]} ${args[2]} ${args[3]}`, \n      mode: ACTIVE_EFFECT_MODES.CUSTOM\n      }\n    ],\n    flags: {\n        dae: {\n            macroRepeat: macroRepeat,\n            //specialDuration: [\"turnStart\"]\n        }\n    },\n    transfer: true,\n  };\nlet item = (typeof args[3] === 'string') ? atoken.actor.items.find(i => i.name === args[3]) : atoken.actor.items.find(i => i.id === args[3]._id);\nlet aCondition = item.data.data.activation.condition;\nif(args[0] === 'on'){\n    \n    if(aCondition && game.cub.hasCondition(aCondition, atarget)){\n        await atoken.actor.deleteEmbeddedEntity(\"ActiveEffect\", effectId);\n    }else{\n        let upItem = Object.assign(REPEAT_EFFECT, {_id: item._id});\n        await atoken.actor.createEmbeddedEntity(\"ActiveEffect\", [REPEAT_EFFECT]);\n    }\n}\n\nif(args[0] === 'off'){\n    let eff = atoken.actor.effects.find(i=> i.data.label === `Repeat_${atarget.name}`);\n    console.log(\"REMOVE\", eff)\n    await atoken.actor.deleteEmbeddedEntity(\"ActiveEffect\", eff.id);\n}","author":"X4uo406iXTm4HkVN","img":"assets/icons/icones-flat/Icon.2_72.png","actorIds":[]}
{"_id":"p0ex9mniXbvgbgRU","name":"DAERollTable","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"//DAERollTable Tablename\nif(args[0] === \"each\"){\n    game.tables.getName(args[1]).draw();\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20.svg","actorIds":[]}
{"name":"Update Cite e Bio","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":1200001,"flags":{"furnace":{"runAsGM":false},"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"Update Cite e Bio","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_12ta9h39ac1","path":"Amostras#/CF_SEP/Generators","color":"#000000","import":true}},"scope":"global","command":"const actorNames = game.actors.map(actor => actor.name).filter((value, index, self) => self.indexOf(value) === index);\nconst journalNames = game.journal.map(journal => journal.name).filter((value, index, self) => self.indexOf(value) === index);\n\nconst indexCite = {\n    Actor: actorNames,\n    JournalEntry: journalNames\n    }\n\ngame.actors.forEach(entry => {\n    //console.log(entry.entity)\n    let newcontent = entry.data.data.details.biography.value;\n    for(const [key, value] of Object.entries(indexCite)){\n        let entityType = key;\n        for (let i = 0; i < value.length; i++) {\n            if(value[i] != entry.name){\n            //let strName = escapeRegExp(value[i]);\n            let str = `(?!\\\\[)\\\\b${value[i]}\\\\b(?![\\\\w\\\\s]*[\\\\]\\\\}])`;\n            //console.log(str);\n            let regEx = new RegExp(str, 'g');\n            if(value[i] != entry.name){\n                //console.log(regEx);\n                newcontent = newcontent.replace(regEx, `@${entityType}[${value[i]}]{${value[i]}}`);\n            }else{\n               newcontent = newcontent.replace(regEx, `<strong>${value[i]}</strong>`); \n            }}\n        }\n        //console.log(newcontent);\n        entry.update({ 'data.details.biography.value': newcontent });\n    }\n    console.log(\"FIM\");\n});\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"p2VSHGKvN2X9dq8W"}
{"name":"AutoRollTableCriticalHit","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":1600001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.4kvkhvolN7IG3tm1"},"cf":{"id":"temp_3qd5z0dngmj","path":"Automação","color":"#0080c0","import":true}},"scope":"global","command":"if(args[0].attackRoll !== undefined && args[0].isCritical){\n    game.tables.getName(\"Acerto Crítico\").draw();\n}else if(args[0].attackRoll !== undefined && args[0].isFumble){\n    game.tables.getName(\"Erro Crítico\").draw();\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-highlight.svg","actorIds":[],"_id":"pEYIgiikScSwfWZd"}
{"_id":"q4aJ0HAtnJ0LSxpm","name":"Actions","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2300001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"//game.macros.entities.find(i => i.name === 'GMActions').execute(game.user.id,token.id,...args);\n\nlet checks = new Innocenti.Actions(game.user,token);\nchecks.Check(...args);","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"name":"Fix Actors (change compendium links)","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":800001,"flags":{"furnace":{"runAsGM":true},"cf":{"id":"temp_12ta9h39ac1","path":"Amostras#/CF_SEP/Generators","color":"#000000","import":true}},"scope":"global","command":"//TROCA OS LINKS DE COMPENDIUM PARA LINKS DO MUNDO.\r\n// COM ECXESSÃO DOS ITEMS QUE MANTÉM NO COMPENDIUM\r\ngame.actors.forEach(entry => {\r\n    let content = entry.data.data.details.biography.value;\r\n    let matches = content.match(/@\\w*\\[([0-9A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ.\\- ]+)\\]?(\\{([0-9A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ;&.\"()\\- ]+)\\})/g);\r\n\r\n    // now we have an array of things such as @Actor[5c8HWfrpvRV4XtZ1]\r\n    if (matches == null) return;\r\n    let newcontent = content;\r\n    let uniqueMatches = matches\r\n        .filter((value, index, self) => self.indexOf(value) === index) //unique matches\r\n        .forEach(str => {\r\n            let firstdata = str.slice(0, -1).split('{');\r\n            let pName = firstdata[1];\r\n            //console.log(firstdata);\r\n            let arrayData = firstdata[0].slice(1, -1).split('['); // cut off the @ and ] then make [0] the type and [1] the id.\r\n            // since the reference may not match directly with the game entity type, lets look that up.\r\n            //console.log(arrayData, pName)\r\n            if (arrayData[0] != 'Compendium') return;\r\n            let pck = arrayData[1].split('.');\r\n            let packname = `${pck[0]}.${pck[1]}`;\r\n            //console.log(packname);\r\n            let id = pck[2];\r\n            let entityType = getEntityType(arrayData[0]);\r\n            \r\n            // with the id and our entity type, look up the name of the entry.\r\n            let packs = game[entityType].get(packname);\r\n            \r\n            if(packs == null){ return console.log(`Não Existe Um compendium com o nome: ${packname} com o item ${entry.name}`)}\r\n            let newEntity = packs.entity;\r\n            //console.log(newEntity);\r\n            if (newEntity === 'Item') return;\r\n            let pindex = packs.index.find(element => element._id === id) || packs.index.find(element => element.name === pName);\r\n            \r\n            if (!pindex) {\r\n                //console.log(packs.index.find(element => element.name == pName), pName, newEntity, packname);\r\n                //return ui.notifications.error(`Could not find any record for the entity type ${entityType} in pack ${packs} with the id of ${id}`);\r\n            }\r\n            let name = (pindex) ? pindex.name : htmlDecode(pName);\r\n            //console.log(name);\r\n\r\n            if (!name) {\r\n                return ui.notifications.error(`Could not find any record for the entity type ${entityType} with the id of ${arrayData[0]}`);\r\n            }\r\n            let changeEntry = (name !== '') ? `@${packs.entity}[${name}]` : '';\r\n            //console.log(changeEntry);\r\n            let newstr = escapeRegExp(firstdata[0]);\r\n            console.log(`updating ${id} with ${name}`);\r\n            let regEx = new RegExp(newstr, 'g');\r\n            //console.log(regEx);\r\n            newcontent = newcontent.replace(regEx, changeEntry);\r\n            //console.log(newcontent);\r\n        });\r\n    entry.update({ 'data.details.biography.value': newcontent });\r\n});\r\nconsole.log(\"FIM\");\r\n\r\nfunction escapeRegExp(string) {\r\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\r\n}\r\nfunction getEntityType(entity) {\r\n    switch (entity) {\r\n        case 'JournalEntry': return 'journal';\r\n        case 'RollTable': return 'tables';\r\n        case 'Compendium': return 'packs';\r\n        default: return entity.toLowerCase() + 's';\r\n    }\r\n}\r\nfunction htmlDecode(input) {\r\n  var doc = new DOMParser().parseFromString(input, \"text/html\");\r\n  return doc.documentElement.textContent;\r\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"qrAlmjw0SSsbbg0F"}
{"_id":"r77c1c4tuuzFWPTJ","name":"Actor Update ID to names","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":600001,"flags":{"furnace":{"runAsGM":true},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_12ta9h39ac1","path":"Amostras#/CF_SEP/Generators","color":"#000000","import":true}},"scope":"global","command":"game.journal.forEach(entry => {\n  let content = entry.data.content;\n  if(entry.folder !== null && entry.folder.name !== \"UPDATE\") return;\n  let matches = content.match(/@\\w*\\[([0-9A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ.\\- ]+)\\]/g);\n  \n  // now we have an array of things such as @Actor[5c8HWfrpvRV4XtZ1]\n  if(matches == null) return;\n  let newcontent = content;\n  let uniqueMatches = matches\n    .filter((value, index, self) => self.indexOf(value) === index) //unique matches\n    .forEach(str => {\n      let arrayData = str.slice(1, -1).split('['); // cut off the @ and ] then make [0] the type and [1] the id.\n      // since the reference may not match directly with the game entity type, lets look that up.\n      //console.log(arrayData)\n      let entityType = getEntityType(arrayData[0]);\n      let packname;\n      if(entityType == 'packs'){\n       let pck =  arrayData[1].split('.');\n       packname = `${pck[0]}.${pck[1]}`;\n       arrayData[1] = pck[2];\n      }\n      let id = arrayData[1];\n      let name;\n      // with the id and our entity type, look up the name of the entry.\n      if(entityType == 'packs'){\n          let packs = game[entityType].get(packname);\n          let pindex = packs.index.find(element => element._id === id) || packs.index.find(element => element.name === id);\n          //console.log(packs);\n          if(!pindex)\n            return ui.notifications.error(`Could not find any record for the entity type ${entityType} in pack ${packs.name} with the id of ${id}`);\n          name = pindex.name;\n      }else{\n          name = game[entityType].get(id)?.name;\n      }\n      //console.log(name)\n      if (!name) {\n        return ui.notifications.error(`Could not find any record for the entity type ${entityType} with the id of ${arrayData[0]}`);\n      }\n\n      // replace the ID with the name.\n      console.log(`updating ${id} with ${name}`);\n\n      let regEx = new RegExp(id, 'g');\n      newcontent = newcontent.replace(regEx, name);\n      //console.log(newcontent)\n    }); \n  entry.update({ content: newcontent });\n});\n\nfunction getEntityType(entity) {\n  switch (entity) {\n    case 'JournalEntry': return 'journal';\n    case 'RollTable': return 'tables';\n    case 'Compendium': return 'packs';\n    default: return entity.toLowerCase() + 's';\n  }\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"rp1CpxtFxPK7Mpd5","name":"PoolFlags","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":3000001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"cf":{"id":"temp_0l73n89jupi","path":"Automação#/CF_SEP/Automação Master","color":"#0080ff","import":true}},"scope":"global","command":"//console.log(token.id);\n//console.log(args)\nlet pool = new Innocenti.PoolFlags(token.id, ...args);\nif(event == 'leave') pool.remove = true;\npool.AddPool();\npool.RemovePool();","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"name":"SeeID","permission":{"default":0,"bE4FsemgBF2CPXB2":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4600001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"//Display Name & IDs\r\nfor(let token of canvas.tokens.controlled)\r\n{\r\n    ChatMessage.create({\r\n        content : token.name + \" \" + token.id\r\n    });\r\n}\r\n\r\nfor(let wall of canvas.walls.controlled)\r\n{\r\n    ChatMessage.create({\r\n        content : wall.name + \" \" + wall.id\r\n    })\r\n}\r\n/*\r\nfor(let light of canvas.lighting.activate)\r\n{\r\n    ChatMessage.create({\r\n        content : light.name + \" \" + light.id\r\n    })\r\n}\r\nfor (let note of canvas.notes.placeables)\r\n{\r\n    ChatMessage.create({\r\n        content :  note.name + \" \" + note.id\r\n     });\r\n}\r\n*/\r\nfor (let draw of canvas.drawings.controlled)\r\n{\r\n   ChatMessage.create({\r\n      content :  draw.name + \" \" + draw.id\r\n   });\r\n}\r\n\r\nfor (let tile of canvas.tiles.controlled)\r\n{\r\n    ChatMessage.create({\r\n        content :  tile.name + \" \" + tile.id\r\n     });\r\n}","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"s1ju65NECwLhcloJ"}
{"_id":"u8AMYs3WeCql28D4","name":"Open Chest","permission":{"default":2,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":1900001,"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.UXJLvaOUS8ANMPkp"},"furnace":{"runAsGM":false},"cf":{"id":"temp_3qd5z0dngmj","path":"Automação","color":"#0080c0","import":true}},"scope":"global","command":"let actions = new InnocentiOpenLock.Actions('OpenLock');","author":"X4uo406iXTm4HkVN","img":"icons/containers/chest/chest-reinforced-box-brown.webp","actorIds":[]}
{"_id":"u8EAAlr7r1wXS9os","name":"Time: LongRest","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":3700001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"cf":{"id":"temp_tu9ff6ho8z","path":"Players Macros#/CF_SEP/Macro GM","color":"#004040","import":true}},"scope":"global","command":"game.Gametime.advanceTime({hours: 7})","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/yellow_39.jpg","actorIds":[]}
{"name":"RollTable: Complications","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":4100001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/d20-grey.svg","tooltip":"RollTable: Complications","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_njjj4vlgt8n","path":"Roll Tables","color":"#008000","import":true}},"scope":"global","command":"game.tables.getName(\"Complications\").draw();","author":"X4uo406iXTm4HkVN","img":"systems/dnd5e/icons/skills/red_28.jpg","actorIds":[],"_id":"uKLu4LW2E3nolDcS"}
{"_id":"uVfHn53UEfhULR6O","name":"Visitar","permission":{"default":2,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":2000001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"macro-marker":{"activeData":{"icon":"icons/svg/hanging-sign.svg","tooltip":"Visitar","colour":"#80ff80","trigger":""}},"cf":{"id":"temp_3qd5z0dngmj","path":"Automação","color":"#0080c0","import":true}},"scope":"global","command":"let visitar = InnocentiVisitar.Visitar();","author":"X4uo406iXTm4HkVN","img":"icons/environment/settlement/house-farmland-small.webp","actorIds":[]}
{"name":"Acid Splash","permission":{"default":0,"0gq993wckhGZNbNh":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Acid Splash\");","author":"0gq993wckhGZNbNh","img":"modules/plutonium/media/icon/spell/phb-acid-splash.jpg","actorIds":[],"_id":"woz6pZaFBVAZANYN"}
{"name":"Suggestion","permission":{"default":0,"0gq993wckhGZNbNh":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Suggestion\");","author":"0gq993wckhGZNbNh","img":"modules/plutonium/media/icon/spell/phb-suggestion.jpg","actorIds":[],"_id":"y5P2RP9yZvWfdNA1"}
{"_id":"zYcu1N3j44wq6IpI","name":"Switch Light","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"game.LightSwitch.flipTheSwitch(\"lightgroup1\")","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"_id":"zfKJ4wTHG8rLtJJs","name":"Update Actors Weapons MidiMacro","permission":{"default":0,"oYLBQUHyYQcwtcvC":3,"X4uo406iXTm4HkVN":3},"type":"script","folder":null,"sort":300001,"flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.7KWn7kV8paHkY2XC"},"cf":{"id":"temp_49cgjf7ubog","path":"Amostras","color":"#000000","import":true}},"scope":"global","command":"let macroname = \"AutoRollTableCriticalHit\";\n\n(async () => {\n    game.actors.forEach(a => {\n        a.items.map(b => {\n            if (b.type === 'weapon' && (b.data.data.actionType === 'mwak' || b.data.data.actionType ==='rwak' || b.data.data.actionType ==='msak' || b.data.data.actionType ==='rsak')) {\n            console.log(b.name)\n                b.setFlag('midi-qol','onUseMacroName', macroname);\n            }\n        })\n    })\nconsole.log(\"Fim - Actors on Game\");\n})();","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[]}
{"name":"Thorn Whip","permission":{"default":0,"Qu7E86Xi2q9u0u1z":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Thorn Whip\");","author":"Qu7E86Xi2q9u0u1z","img":"modules/plutonium/media/icon/spell/phb-thorn-whip.jpg","actorIds":[],"_id":"0Wsx2p3EFZlct7zE"}
{"name":"Produce Flame","permission":{"default":0,"Qu7E86Xi2q9u0u1z":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Produce Flame\");","author":"Qu7E86Xi2q9u0u1z","img":"modules/plutonium/media/icon/spell/phb-produce-flame.jpg","actorIds":[],"_id":"9T79cJzEnfe06WMV"}
{"name":"Control Flames","permission":{"default":0,"Qu7E86Xi2q9u0u1z":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Control Flames\");","author":"Qu7E86Xi2q9u0u1z","img":"modules/plutonium/media/icon/spell/xge-control-flames.jpg","actorIds":[],"_id":"hSzGTWVb5bkcSUum"}
{"name":"Fog Cloud","permission":{"default":0,"Qu7E86Xi2q9u0u1z":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Fog Cloud\");","author":"Qu7E86Xi2q9u0u1z","img":"modules/plutonium/media/icon/spell/phb-fog-cloud.jpg","actorIds":[],"_id":"bHdGGZuGLBPk329w"}
{"name":"Psychic Blades","permission":{"default":0,"Qu7E86Xi2q9u0u1z":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Psychic Blades\");","author":"Qu7E86Xi2q9u0u1z","img":"modules/plutonium/media/icon/mighty-force.svg","actorIds":[],"_id":"kqRoiVCl0FVUPGWW"}
{"name":"Sneak Attack","permission":{"default":0,"Qu7E86Xi2q9u0u1z":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Sneak Attack\");","author":"Qu7E86Xi2q9u0u1z","img":"st%2Csmall%2C845x845-pad%2C1000x1000%2Cf8f8f8.u4%5B1%5D.jpg","actorIds":[],"_id":"5jRkuW8elsqwJzO5"}
{"$$deleted":true,"_id":"kqRoiVCl0FVUPGWW"}
{"name":"Psychic Blades","permission":{"default":0,"Qu7E86Xi2q9u0u1z":3},"type":"script","sort":100001,"flags":{"dnd5e":{"itemMacro":true}},"scope":"global","command":"game.dnd5e.rollItemMacro(\"Psychic Blades\");","author":"Qu7E86Xi2q9u0u1z","img":"modules/plutonium/media/icon/transparent%5B1%5D.png","actorIds":[],"_id":"IJ0SQf3PwAuCpOxL"}
{"name":"LMRTFY: Get Rolling!","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{},"scope":"global","command":"// Get Rolling! \n// Request rolls from Amara Cranberries, Diorito D. Duskrock, Edgar \"Scar\" Jackson, Hanzo Hasashi, Roan Drachenys, Sir Anuran\n// Abilities: \n// Saves: \n// Skills: Perception\nconst data = {\n  \"user\": \"character\",\n  \"actors\": [\n    \"QrHH3qai5z0TKSQU\",\n    \"qrd5YRS4WKknWoxb\",\n    \"pAyFT10eMYpEVRSr\",\n    \"UQ3IbPlZ7hhH3jHC\",\n    \"631E5TJLxL8beShk\",\n    \"qS5ZN9kiGI1AaQww\"\n  ],\n  \"abilities\": [],\n  \"saves\": [],\n  \"skills\": [\n    \"prc\"\n  ],\n  \"advantage\": 0,\n  \"mode\": \"roll\",\n  \"title\": \"Get Rolling!\",\n  \"message\": \"\",\n  \"formula\": \"\",\n  \"deathsave\": false,\n  \"initiative\": false,\n  \"tables\": []\n};\n\ngame.socket.emit('module.lmrtfy', data);\n","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-highlight.svg","actorIds":[],"_id":"RjmKE3A4OLodlsJw"}
{"_id":"RjmKE3A4OLodlsJw","name":"LMRTFY: Get Rolling!","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"// Get Rolling! \n// Request rolls from Amara Cranberries, Diorito D. Duskrock, Edgar \"Scar\" Jackson, Hanzo Hasashi, Roan Drachenys, Sir Anuran\n// Abilities: \n// Saves: \n// Skills: Perception\nconst data = {\n  \"user\": \"character\",\n  \"actors\": [\n    \"QrHH3qai5z0TKSQU\",\n    \"qrd5YRS4WKknWoxb\",\n    \"pAyFT10eMYpEVRSr\",\n    \"UQ3IbPlZ7hhH3jHC\",\n    \"631E5TJLxL8beShk\",\n    \"qS5ZN9kiGI1AaQww\"\n  ],\n  \"abilities\": [],\n  \"saves\": [],\n  \"skills\": [\n    \"prc\"\n  ],\n  \"advantage\": 0,\n  \"mode\": \"roll\",\n  \"title\": \"Get Rolling!\",\n  \"message\": \"\",\n  \"formula\": \"\",\n  \"deathsave\": false,\n  \"initiative\": false,\n  \"tables\": []\n};\n\ngame.socket.emit('module.lmrtfy', data);","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-highlight.svg","actorIds":[]}
{"_id":"RjmKE3A4OLodlsJw","name":"LMRTFY: Get Rolling! Perc","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"// Get Rolling! \n// Request rolls from Amara Cranberries, Diorito D. Duskrock, Edgar \"Scar\" Jackson, Hanzo Hasashi, Roan Drachenys, Sir Anuran\n// Abilities: \n// Saves: \n// Skills: Perception\nconst data = {\n  \"user\": \"character\",\n  \"actors\": [\n    \"QrHH3qai5z0TKSQU\",\n    \"qrd5YRS4WKknWoxb\",\n    \"pAyFT10eMYpEVRSr\",\n    \"UQ3IbPlZ7hhH3jHC\",\n    \"631E5TJLxL8beShk\",\n    \"qS5ZN9kiGI1AaQww\"\n  ],\n  \"abilities\": [],\n  \"saves\": [],\n  \"skills\": [\n    \"prc\"\n  ],\n  \"advantage\": 0,\n  \"mode\": \"roll\",\n  \"title\": \"Get Rolling!\",\n  \"message\": \"\",\n  \"formula\": \"\",\n  \"deathsave\": false,\n  \"initiative\": false,\n  \"tables\": []\n};\n\ngame.socket.emit('module.lmrtfy', data);","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-highlight.svg","actorIds":[]}
{"name":"LMRTFY: Get Rolling!","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{},"scope":"global","command":"// Get Rolling! \n// Request rolls from Amara Cranberries, Diorito D. Duskrock, Edgar \"Scar\" Jackson, Hanzo Hasashi, Roan Drachenys, Sir Anuran\n// Abilities: \n// Saves: \n// Skills: Survival\nconst data = {\n  \"user\": \"character\",\n  \"actors\": [\n    \"QrHH3qai5z0TKSQU\",\n    \"qrd5YRS4WKknWoxb\",\n    \"pAyFT10eMYpEVRSr\",\n    \"UQ3IbPlZ7hhH3jHC\",\n    \"631E5TJLxL8beShk\",\n    \"qS5ZN9kiGI1AaQww\"\n  ],\n  \"abilities\": [],\n  \"saves\": [],\n  \"skills\": [\n    \"sur\"\n  ],\n  \"advantage\": 0,\n  \"mode\": \"roll\",\n  \"title\": \"Get Rolling!\",\n  \"message\": \"\",\n  \"formula\": \"\",\n  \"deathsave\": false,\n  \"initiative\": false,\n  \"tables\": []\n};\n\ngame.socket.emit('module.lmrtfy', data);\n","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-highlight.svg","actorIds":[],"_id":"XXFputy3YjcnD0fn"}
{"_id":"XXFputy3YjcnD0fn","name":"LMRTFY: Get Rolling! Surv","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"// Get Rolling! \n// Request rolls from Amara Cranberries, Diorito D. Duskrock, Edgar \"Scar\" Jackson, Hanzo Hasashi, Roan Drachenys, Sir Anuran\n// Abilities: \n// Saves: \n// Skills: Survival\nconst data = {\n  \"user\": \"character\",\n  \"actors\": [\n    \"QrHH3qai5z0TKSQU\",\n    \"qrd5YRS4WKknWoxb\",\n    \"pAyFT10eMYpEVRSr\",\n    \"UQ3IbPlZ7hhH3jHC\",\n    \"631E5TJLxL8beShk\",\n    \"qS5ZN9kiGI1AaQww\"\n  ],\n  \"abilities\": [],\n  \"saves\": [],\n  \"skills\": [\n    \"sur\"\n  ],\n  \"advantage\": 0,\n  \"mode\": \"roll\",\n  \"title\": \"Get Rolling!\",\n  \"message\": \"\",\n  \"formula\": \"\",\n  \"deathsave\": false,\n  \"initiative\": false,\n  \"tables\": []\n};\n\ngame.socket.emit('module.lmrtfy', data);","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-highlight.svg","actorIds":[]}
{"name":"New Macro","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"chat","sort":100001,"flags":{},"scope":"global","command":"","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"oPdI1bbnwBzJyYNn"}
{"$$deleted":true,"_id":"oPdI1bbnwBzJyYNn"}
{"name":"New Macro","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"chat","sort":100001,"flags":{},"scope":"global","command":"","author":"X4uo406iXTm4HkVN","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"NZuKEdesyXqL6P2U"}
{"$$deleted":true,"_id":"NZuKEdesyXqL6P2U"}
{"$$deleted":true,"_id":"XXFputy3YjcnD0fn"}
{"name":"LMRTFY: Get Rolling!","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{},"scope":"global","command":"// Get Rolling! \n// Request rolls from Amara Cranberries, Diorito D. Duskrock, Edgar \"Scar\" Jackson, Hanzo Hasashi, Roan Drachenys, Sir Anuran\n// Abilities: \n// Saves: \n// Skills: Survival\nconst data = {\n  \"user\": \"character\",\n  \"actors\": [\n    \"QrHH3qai5z0TKSQU\",\n    \"qrd5YRS4WKknWoxb\",\n    \"pAyFT10eMYpEVRSr\",\n    \"UQ3IbPlZ7hhH3jHC\",\n    \"631E5TJLxL8beShk\",\n    \"qS5ZN9kiGI1AaQww\"\n  ],\n  \"abilities\": [],\n  \"saves\": [],\n  \"skills\": [\n    \"sur\"\n  ],\n  \"advantage\": 0,\n  \"mode\": \"roll\",\n  \"title\": \"Get Rolling!\",\n  \"message\": \"\",\n  \"formula\": \"\",\n  \"deathsave\": false,\n  \"initiative\": false,\n  \"tables\": []\n};\n\ngame.socket.emit('module.lmrtfy', data);\n","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-highlight.svg","actorIds":[],"_id":"Fpy1vWTYGSOBhG64"}
{"_id":"Fpy1vWTYGSOBhG64","name":"LMRTFY: Get Rolling!","permission":{"default":0,"X4uo406iXTm4HkVN":3},"type":"script","sort":100001,"flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false}},"scope":"global","command":"// Get Rolling! \n// Request rolls from Amara Cranberries, Diorito D. Duskrock, Edgar \"Scar\" Jackson, Hanzo Hasashi, Roan Drachenys, Sir Anuran\n// Abilities: \n// Saves: \n// Skills: Survival\nconst data = {\n  \"user\": \"character\",\n  \"actors\": [\n    \"QrHH3qai5z0TKSQU\",\n    \"qrd5YRS4WKknWoxb\",\n    \"pAyFT10eMYpEVRSr\",\n    \"UQ3IbPlZ7hhH3jHC\",\n    \"631E5TJLxL8beShk\",\n    \"qS5ZN9kiGI1AaQww\"\n  ],\n  \"abilities\": [],\n  \"saves\": [],\n  \"skills\": [\n    \"sur\"\n  ],\n  \"advantage\": 0,\n  \"mode\": \"roll\",\n  \"title\": \"Get Rolling!\",\n  \"message\": \"\",\n  \"formula\": \"\",\n  \"deathsave\": false,\n  \"initiative\": false,\n  \"tables\": []\n};\n\ngame.socket.emit('module.lmrtfy', data);","author":"X4uo406iXTm4HkVN","img":"icons/svg/d20-highlight.svg","actorIds":[]}
